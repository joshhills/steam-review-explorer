(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{48116:function(e,t,n){"use strict";var r;function a(e){return a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}!function(i){var s=arguments,u=function(){var e=/d{1,4}|D{3,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|W{1,2}|[LlopSZN]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,n=/[^-+\dA-Z]/g;return function(r,a,i,f){if(1!==s.length||"string"!==m(r)||/\d/.test(r)||(a=r,r=void 0),(r=r||0===r?r:new Date)instanceof Date||(r=new Date(r)),isNaN(r))throw TypeError("Invalid date");var y=(a=String(u.masks[a]||a||u.masks.default)).slice(0,4);"UTC:"!==y&&"GMT:"!==y||(a=a.slice(4),i=!0,"GMT:"===y&&(f=!0));var h=function(){return i?"getUTC":"get"},v=function(){return r[h()+"Date"]()},p=function(){return r[h()+"Day"]()},b=function(){return r[h()+"Month"]()},g=function(){return r[h()+"FullYear"]()},x=function(){return r[h()+"Hours"]()},N=function(){return r[h()+"Minutes"]()},M=function(){return r[h()+"Seconds"]()},D=function(){return r[h()+"Milliseconds"]()},j=function(){return i?0:r.getTimezoneOffset()},T=function(){return c(r)},w={d:function(){return v()},dd:function(){return o(v())},ddd:function(){return u.i18n.dayNames[p()]},DDD:function(){return l({y:g(),m:b(),d:v(),_:h(),dayName:u.i18n.dayNames[p()],short:!0})},dddd:function(){return u.i18n.dayNames[p()+7]},DDDD:function(){return l({y:g(),m:b(),d:v(),_:h(),dayName:u.i18n.dayNames[p()+7]})},m:function(){return b()+1},mm:function(){return o(b()+1)},mmm:function(){return u.i18n.monthNames[b()]},mmmm:function(){return u.i18n.monthNames[b()+12]},yy:function(){return String(g()).slice(2)},yyyy:function(){return o(g(),4)},h:function(){return x()%12||12},hh:function(){return o(x()%12||12)},H:function(){return x()},HH:function(){return o(x())},M:function(){return N()},MM:function(){return o(N())},s:function(){return M()},ss:function(){return o(M())},l:function(){return o(D(),3)},L:function(){return o(Math.floor(D()/10))},t:function(){return x()<12?u.i18n.timeNames[0]:u.i18n.timeNames[1]},tt:function(){return x()<12?u.i18n.timeNames[2]:u.i18n.timeNames[3]},T:function(){return x()<12?u.i18n.timeNames[4]:u.i18n.timeNames[5]},TT:function(){return x()<12?u.i18n.timeNames[6]:u.i18n.timeNames[7]},Z:function(){return f?"GMT":i?"UTC":(String(r).match(t)||[""]).pop().replace(n,"").replace(/GMT\+0000/g,"UTC")},o:function(){return(j()>0?"-":"+")+o(100*Math.floor(Math.abs(j())/60)+Math.abs(j())%60,4)},p:function(){return(j()>0?"-":"+")+o(Math.floor(Math.abs(j())/60),2)+":"+o(Math.floor(Math.abs(j())%60),2)},S:function(){return["th","st","nd","rd"][v()%10>3?0:(v()%100-v()%10!=10)*v()%10]},W:function(){return T()},WW:function(){return o(T())},N:function(){return d(r)}};return a.replace(e,(function(e){return e in w?w[e]():e.slice(1,e.length-1)}))}}();u.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",paddedShortDate:"mm/dd/yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},u.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]};var o=function(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e},l=function(e){var t=e.y,n=e.m,r=e.d,a=e._,i=e.dayName,s=e.short,u=void 0!==s&&s,o=new Date,l=new Date;l.setDate(l[a+"Date"]()-1);var c=new Date;c.setDate(c[a+"Date"]()+1);return o[a+"FullYear"]()===t&&o[a+"Month"]()===n&&o[a+"Date"]()===r?u?"Tdy":"Today":l[a+"FullYear"]()===t&&l[a+"Month"]()===n&&l[a+"Date"]()===r?u?"Ysd":"Yesterday":c[a+"FullYear"]()===t&&c[a+"Month"]()===n&&c[a+"Date"]()===r?u?"Tmw":"Tomorrow":i},c=function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);var n=new Date(t.getFullYear(),0,4);n.setDate(n.getDate()-(n.getDay()+6)%7+3);var r=t.getTimezoneOffset()-n.getTimezoneOffset();t.setHours(t.getHours()-r);var a=(t-n)/6048e5;return 1+Math.floor(a)},d=function(e){var t=e.getDay();return 0===t&&(t=7),t},m=function(e){return null===e?"null":void 0===e?"undefined":"object"!==a(e)?a(e):Array.isArray(e)?"array":{}.toString.call(e).slice(8,-1).toLowerCase()};void 0===(r=function(){return u}.call(t,n,t,e))||(e.exports=r)}(void 0)},41057:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/storage",function(){return n(68018)}])},68018:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return D}});var r=n(47568),a=n(70655),i=n(85893),s=n(67294),u=n(48116),o=n.n(u),l=n(78182),c=n(35005),d=function(e){var t=e.game,n=e.search,r=e.quotaPercent,a=e.reviewCount,s=e.totalReviews,u=e.handleDelete,d=a>0?Math.round(a/s*100):0,m=Math.round(d/100*r);return(0,i.jsxs)(l.Z,{className:"mb-4 game-card",children:[(0,i.jsx)(l.Z.Img,{variant:"top",src:t.header_image}),(0,i.jsxs)(l.Z.Body,{children:[(0,i.jsx)(l.Z.Title,{children:(0,i.jsx)("a",{href:"/steam-review-explorer/game/".concat(t.steam_appid,"?start=").concat(n.start,"&end=").concat(n.end),children:t.name})}),(0,i.jsxs)(l.Z.Subtitle,{className:"mb-2 text-muted",children:["Using ",m,"% of overall space"]}),(0,i.jsxs)(l.Z.Subtitle,{className:"mb-2 text-muted",children:["Last updated ",o()(new Date(n.when),"hh:MMtt, dd/mm/yyyy")]}),(0,i.jsxs)(l.Z.Text,{className:"small",children:[a.toLocaleString()," review",1===a?"":"s"," stored"]})]}),(0,i.jsx)(l.Z.Footer,{children:(0,i.jsx)("div",{className:"d-grid gap-2",children:(0,i.jsx)(c.Z,{variant:"primary",className:"float-end",onClick:function(){return u(t.steam_appid)},children:"Delete"})})})]},t.steam_appid)},m=function(e){var t=e.games,n=e.searches,r=e.quotaPercent,a=e.reviewCounts,s=e.handleDelete,u=Object.values(a).reduce((function(e,t){return e+t}));return(0,i.jsx)("div",{className:"row",children:Object.keys(t).sort((function(e,t){return a[t]-a[e]})).map((function(e){return(0,i.jsx)("div",{className:"col-auto mb-3",children:(0,i.jsx)(d,{game:t[e],search:n[e],quotaPercent:r,reviewCount:a[e],totalReviews:u,handleDelete:s})},t[e].steam_appid)}))})},f=n(84427),y=n(76572),h=n(41664),v=n.n(h),p=n(26699),b=n(51479),g=n(34051),x=n(36968),N=n(10682),M=10737418240;function D(){var e=(0,s.useState)(null),t=e[0],n=e[1],u=(0,s.useState)({}),o=u[0],l=u[1],d=(0,s.useState)({}),h=d[0],D=d[1],j=(0,s.useState)(!0),T=j[0],w=j[1],S=(0,s.useState)({}),Z=S[0],P=S[1],_=function(){w(!0);var e=[];e.push(f.Z.getStorageQuota().then((function(e){M<e.quota?e.quota=M:e.quota/=2,n(e)}))),e.push(f.Z.listReviewsInDatabase().then((function(e){l(e);var t=[],n=[],r=!0,a=!1,i=void 0;try{for(var s,u=Object.keys(e)[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var o=s.value;t.push(y.Z.getGame(o)),n.push(f.Z.getSearch(o))}}catch(m){a=!0,i=m}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}var c=Promise.all(t).then((function(e){var t={},n=!0,r=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var u=i.value;t[u.steam_appid]=u}}catch(m){r=!0,a=m}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}D(t)})),d=Promise.all(n).then((function(e){var t={},n=!0,r=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var u=i.value;t[u.appid]=u}}catch(m){r=!0,a=m}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}P(t)}));return Promise.all([c,d])}))),Promise.all(e).then((function(){w(!1)}))};(0,s.useEffect)((function(){_()}),[]);var H=null;t&&(H=Math.round(t.usage/t.quota*100));var C=function(){var e=(0,r.Z)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,f.Z.deleteGame(e)];case 1:return t.sent(),delete h[e],delete o[e],_(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=(0,r.Z)((function(){var e,t,n,r,i,s,u;return(0,a.__generator)(this,(function(a){e=[],t=!0,n=!1,r=void 0;try{for(i=Object.keys(h)[Symbol.iterator]();!(t=(s=i.next()).done);t=!0)u=s.value,e.push(f.Z.deleteGame(u))}catch(o){n=!0,r=o}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return[2,Promise.all(e).then((function(){D({}),l({}),P({}),_()}))]}))}));return function(){return e.apply(this,arguments)}}(),O="info";return H>=60&&(O="warning"),H>=80&&(O="danger"),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"bg-light rounded-3 p-3 mb-4",children:(0,i.jsxs)(p.Z,{className:"mb-0",children:[(0,i.jsx)("li",{className:"breadcrumb-item",children:(0,i.jsx)(v(),{href:"/",children:"Home"})}),(0,i.jsx)(p.Z.Item,{active:!0,children:"Storage"})]})}),!T&&null!==H&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.Z,{className:"mb-3",variant:O,now:H}),(0,i.jsxs)("p",{className:"text-center text-".concat(O),children:[H,"% estimated available site storage space used",H>=80&&", consider deleting some games",H>=95&&", site may fail to function properly otherwise"]}),Object.keys(h).length>0&&(0,i.jsx)("div",{className:"text-center mb-3",children:(0,i.jsx)(c.Z,{onClick:k,children:"Delete All"})})]}),T&&(0,i.jsx)(g.Z,{children:(0,i.jsx)(x.Z,{className:"mx-auto mt-2",animation:"border",role:"status",children:(0,i.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}),!T&&0===Object.keys(h).length&&(0,i.jsx)("p",{className:"text-center text-muted",children:"Scraped games will appear here"}),!T&&Object.keys(h).length>0&&(0,i.jsx)(N.Z,{children:(0,i.jsx)(N.Z,{children:(0,i.jsx)(m,{games:h,searches:Z,quotaPercent:H,reviewCounts:o,handleDelete:C})})})]})}},26699:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var r=n(44036),a=n.n(r),i=n(67294),s=n(76792),u=n(70080),o=n(85893);const l=i.forwardRef((({bsPrefix:e,active:t,children:n,className:r,as:i="li",linkAs:l=u.Z,linkProps:c,href:d,title:m,target:f,...y},h)=>{const v=(0,s.vE)(e,"breadcrumb-item");return(0,o.jsx)(i,{ref:h,...y,className:a()(v,r,{active:t}),"aria-current":t?"page":void 0,children:t?n:(0,o.jsx)(l,{...c,href:d,title:m,target:f,children:n})})}));l.displayName="BreadcrumbItem",l.defaultProps={active:!1,linkProps:{}};var c=l;const d=i.forwardRef((({bsPrefix:e,className:t,listProps:n,children:r,label:i,as:u="nav",...l},c)=>{const d=(0,s.vE)(e,"breadcrumb");return(0,o.jsx)(u,{"aria-label":i,className:t,ref:c,...l,children:(0,o.jsx)("ol",{...n,className:a()(d,null==n?void 0:n.className),children:r})})}));d.displayName="Breadcrumb",d.defaultProps={label:"breadcrumb",listProps:{}};var m=Object.assign(d,{Item:c})},51479:function(e,t,n){"use strict";var r=n(44036),a=n.n(r),i=n(67294),s=n(76792),u=n(53439),o=n(85893);function l(e,t,n){const r=(e-t)/(n-t)*100;return Math.round(1e3*r)/1e3}function c({min:e,now:t,max:n,label:r,visuallyHidden:i,striped:s,animated:u,className:c,style:d,variant:m,bsPrefix:f,...y},h){return(0,o.jsx)("div",{ref:h,...y,role:"progressbar",className:a()(c,`${f}-bar`,{[`bg-${m}`]:m,[`${f}-bar-animated`]:u,[`${f}-bar-striped`]:u||s}),style:{width:`${l(t,e,n)}%`,...d},"aria-valuenow":t,"aria-valuemin":e,"aria-valuemax":n,children:i?(0,o.jsx)("span",{className:"visually-hidden",children:r}):r})}const d=i.forwardRef((({isChild:e,...t},n)=>{if(t.bsPrefix=(0,s.vE)(t.bsPrefix,"progress"),e)return c(t,n);const{min:r,now:l,max:d,label:m,visuallyHidden:f,striped:y,animated:h,bsPrefix:v,variant:p,className:b,children:g,...x}=t;return(0,o.jsx)("div",{ref:n,...x,className:a()(b,v),children:g?(0,u.UI)(g,(e=>(0,i.cloneElement)(e,{isChild:!0}))):c({min:r,now:l,max:d,label:m,visuallyHidden:f,striped:y,animated:h,bsPrefix:v,variant:p},n)})}));d.displayName="ProgressBar",d.defaultProps={min:0,max:100,animated:!1,isChild:!1,visuallyHidden:!1,striped:!1},t.Z=d}},function(e){e.O(0,[662,923,572,774,888,179],(function(){return t=41057,e(e.s=t);var t}));var t=e.O();_N_E=t}]);